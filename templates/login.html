{% extends "base.html" %}

{% block head %}
<title>Login</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        text-align: center;
    }
    form {
        background: #fff;
        padding: 20px;
        border-radius: 5px;
        box-shadow: 0px 0px 10px 0px #000;
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 300px; /* Adjust width as needed */
        margin: auto;
    }
    input[type="text"], input[type="password"] {
        margin: 10px 0;
        padding: 10px;
        width: calc(100% - 20px); /* Full width minus padding */
    }
    input[type="submit"] {
        background: #333;
        color: white;
        padding: 10px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        width: calc(100% - 20px); /* Full width minus padding */
    }
    input[type="submit"]:hover {
        background: #555;
    }
    .error {
        color: red;
    }
</style>
    <script>
    async function loginUser(event) {
        event.preventDefault(); // Prevent the default form submission

        const formData = new FormData(event.target);

        try {
            const response = await fetch('https://karirku-backend.meervix.com/user/login/', {
                method: 'POST',
                body: formData
            });

            if (!response.ok) {
                throw new Error('Login failed');
            }

            const result = await response.json();
            console.log(result)
            document.cookie = `access_token=${result.access}; path=/`;
            document.cookie = `refresh_token=${result.refresh}; path=/`;

            alert('Login successful!');
            window.location.href = "/";
        } catch (error) {
            alert(error.message); 
        }
    }
</script>
{% endblock %}


{% block content %}
<div>
    <h2>Login</h2>
    <p class="error" id="error-message" style="display: none;"></p>
    <form onsubmit="loginUser(event)">
        <input type="text" name="email" placeholder="Email" required>
        <input type="password" name="password" placeholder="Password" required>
        <input type="submit" value="Login">
    </form>
</div>
{% endblock %}
